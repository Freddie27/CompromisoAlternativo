CREATE PROCEDURE PartLeer
AS
select * from PARTICIPANTE
GO;


CREATE PROCEDURE PartA単adir(

@PART_RUT VARCHAR(10),
@PART_NOMBRE VARCHAR(100),
@PART_FONO VARCHAR(12),
@PART_EMAIL VARCHAR(80),
@PART_INSTITUCION VARCHAR(80),
@Mensaje VARCHAR(500) output,
@Resultado int output
)
AS
BEGIN
SET @Resultado=0
if not exists (SELECT* FROM PARTICIPANTE WHERE PART_RUT = @PART_RUT)
begin
INSERT INTO PARTICIPANTE(PART_RUT,PART_NOMBRE,PART_FONO,PART_EMAIL,PART_INSTITUCION) 
VALUES (@PART_RUT,@PART_NOMBRE,@PART_FONO,@PART_EMAIL,@PART_INSTITUCION)
SET @Resultado = SCOPE_IDENTITY()
end
else
set @Mensaje = 'El Rut Ya existe'
end





Create procedure PartEditar(
@PART_ID Numeric (6,0),
@PART_RUT VARCHAR(10),
@PART_NOMBRE VARCHAR(100),
@PART_FONO VARCHAR(12),
@PART_EMAIL VARCHAR(80),
@PART_INSTITUCION VARCHAR(80),
@Mensaje varchar(500) output,
@Resultado bit output
)
as
begin
set @Resultado = 0
IF NOT EXISTS (SELECT * FROM PARTICIPANTE WHERE PART_RUT=@PART_RUT AND PART_ID != @PART_ID)
BEGIN

UPDATE TOP(1) PARTICIPANTE SET
PART_NOMBRE = @PART_NOMBRE,
PART_FONO = @PART_FONO,
PART_EMAIL = @PART_EMAIL,
PART_INSTITUCION = @PART_INSTITUCION
WHERE PART_ID = @PART_ID
SET @Resultado = 1 
END
ELSE
SET @Mensaje='El rut ingresado ya existe'
end

DROP PROCEDURE ActiLeer

create procedure ActiLeer
as
select* from ACTIVIDAD
go;


create procedure ActiLeer
as
SELECT ACTIVIDAD.ACTI_ID,ACTIVIDAD.ACTI_FECHA_REG,TIPO_ACTIVIDAD.TACT_NOMBRE,ACTIVIDAD.ACTI_MOTIVO,ACTIVIDAD.ACTI_DESARROLLO,ACTIVIDAD.ACTI_REGISTRO_ACT 
FROM ACTIVIDAD
INNER JOIN TIPO_ACTIVIDAD ON ACTIVIDAD.ACTI_TIPO = TIPO_ACTIVIDAD.TACT_ID;
end







drop procedure ActiA単adir

create procedure ActiA単adir(


@ACTI_TIPO NUMERIC (2,0),
@ACTI_MOTIVO VARCHAR(200),
@ACTI_DESARROLLO VARCHAR(3000),
@Mensaje VARCHAR(500) output,
@Resultado int output
)
AS
BEGIN
SET @Resultado=0
INSERT INTO ACTIVIDAD(ACTI_FECHA_REG,ACTI_TIPO,ACTI_MOTIVO,ACTI_DESARROLLO,ACTI_REGISTRO_ACT)
VALUES (CURRENT_TIMESTAMP,@ACTI_TIPO,@ACTI_MOTIVO,@ACTI_DESARROLLO,'S')
SET @Resultado = SCOPE_IDENTITY()

end

drop procedure ActiA単adir